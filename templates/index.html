{% extends 'base.html' %}

{% block title %}SMU Mental Health and Wellness{% endblock %}

{% block content %}
    <script 
        src="https://www.unpkg.com/@propelauth/javascript@2.0.11/dist/javascript.min.js" 
        integrity="sha384-FENNH2f7QuQvkZJBL7jebLr0OtYKgTA2iq+C5g3VXXX7SBwWmeMMoc+pBBtcn76G" 
        crossorigin="anonymous"></script>

    <script type="module" src="{{ url_for('static', filename='index.js') }}"></script>

   <section class="jumbotron text-center">
       <div class="container">
           <h1 class="jumbotron-heading">Welcome!</h1>
           <p class="lead text-muted">
           Please login to the platform!
           </p>
           <a class="btn btn-primary my-2" href="#">Login</a>
           <a class="btn btn-secondary my-2" href="#">Sign up</a>
       </div>
   </section>

    <!-- Login Status Display -->
    <div id="display-when-logged-out">
        <p>You are not logged in</p>
        <button id="signup">Sign Up</button>
        <button id="login">Login</button>
    </div>
    <div id="display-when-logged-in" style="display: none;">
        <p>You are logged in <span id="email"></span></p>
        <button id="account">Account</button>
        <button id="logout">Logout</button>
    </div>

   {% for post in posts %}
        <a href="#"><h2>{{ post['title'] }}</h2></a>
        <span class="badge badge-primary">{{ post['created'] }}</span>
        <hr />
   {% endfor %}

    <form onsubmit="return setNewGoalAction(this)" method="post">
        <label for="name">Name of goal:</label>
        <input type="text" id="name" name="name" required maxlength="25" size="10" /><br/>
        <label for="type">Type of goal:</label>
        <input type="radio" name="type">Physical</input>
        <input type="radio" name="type">Mental</input><br/>
        <label for="day">Days for goal:</label>
        <input type="checkbox" id="0" name="day">Sunday</input>
        <input type="checkbox" id="1" name="day">Monday</input>
        <input type="checkbox" id="2" name="day">Tuesday</input>
        <input type="checkbox" id="3" name="day">Wednesday</input>
        <input type="checkbox" id="4" name="day">Thursday</input>
        <input type="checkbox" id="5" name="day">Friday</input>
        <input type="checkbox" id="6" name="day">Saturday</input><br/>
        <button type="submit">Add goal</button>
    </form>

    <script>
    function setNewGoalAction(form) {
        let name = document.getElementById("name").value;
        let t = Array.from(document.getElementsByName("type")).map(x => x.checked);
        let type = t[0] ? "physical" : "mental";
        let d = Array.from(document.getElementsByName("day")).map(x => x.checked + 0);
        form.action = "/add?name=" + name + "&type=" + type + "&d0=" + d[0] +
           "&d1=" + d[1] + "&d2=" + d[2] + "&d3=" + d[3] + "&d4=" + d[4] + "&d5=" + d[5] + "&d6=" + d[6];
        return true;
    }
    </script>

{% endblock %}
